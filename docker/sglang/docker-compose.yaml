# docker/sglang/docker-compose.yaml
version: '3.8'

services:
  sglang:
    build: .
    ports:
      - "${PORT:-28004}:28004"
    environment:
      - CUDA_VISIBLE_DEVICES=${CUDA_DEVICE:-0}
      - MODEL_PATH=${MODEL_PATH:-Qwen/Qwen3-VL-4B-Instruct}
      - DTYPE=${DTYPE:-bfloat16}
      - MEM_FRACTION=${MEM_FRACTION:-0.85}
    volumes:
      - ~/.cache/huggingface:/root/.cache/huggingface
    shm_size: '16gb'
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: ['${CUDA_DEVICE:-0}']
              capabilities: [gpu]
